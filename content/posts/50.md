+++
title = 'SMC-777 に FDD エミュレータを接続する'
date = 2025-08-18T09:47:08+09:00
draft = true
+++
Gotek を SMC-777 で動かすためのまとめ

# はじめに

SMC-777 は FD ドライブ内蔵のレトロPC ですが、
レトロPC の定めとして御多分に漏れず FD ドライブが不調になります。
手持ちの個体は FD ドライブのモータが動かず、故障している状態です。

SMC-777 は ROM 上に OS や BASIC を持っていないため、
FD が動かないとなにもできません。

一方、レトロPC界隈でよくつ分かれているのは GOTEK と呼ばれる FD エミュレータです。
一般的には、これに FlashFloppy というファームウェアを書き込んで使用します。

今回は SMC-777 に GOTEK w/FlashFloppy を接続してみます。

# 接続

SMC-777 で使用されているのは、かなり初期の 3.5 インチ FD ドライブで、
一般的な 34 pin コネクタと互換性のない 26 pin のコネクタが使用されています。

この接続をなんとかしないといけないのですが、

https://forum.vcfed.org/index.php?threads/looking-for-sord-m23p-boot-disk.66793/page-2

これに従って変換コネクタを作成します。

```
SMC-777         Gotek
1 (MOTOR)       16
2 (SELECT_0)	10
4 (SELECT_1)	12
6 (DIR)         18
7, 9, 11, 13, 15, 17, 19, 21, 23, 25	GND
8 (STEP)        20
10 (WR DATA)	22
12 (WR GATE)	24
18 (INDEX)      8
20 (TRACK 0)	26
22 (WR_PROT)	28
24 (RD DATA)	30
26 (READY)      34
```

SMC-777 本体の FD ケーブルのクリアランスに余裕がないので、
26pin コネクタの場所はオリジナルの FDD の 26pin コネクタの位置からあまり移動できません。

よってこんな感じの変換コネクタ(右側)が必要になります。
左側のコネクタは最初に作成したものですが、SMC-777 に接続できませんでした。

![Conversion connector](/images/smcgotek00.jpg)

電源も延長が必要なので、適当なコネクタで延長ケーブルを作成してください。

# 設置

SMC-777 の FD マウンタの場所にそのまま　GOTEK を設置すると、
ボタンや USB メモリの差し込み口が本体カバーに干渉してしまいます。

そこで、何らかの下駄をかませて GOTEK の設置場所を移動する必要があります。
適当にネットを検索してみると、以下のようなものが見つかりました。

https://www.printables.com/model/192083-gotek-mounting-bracket-for-checkmate-1500-plus/files


このままではまだ高さが足りないので、単純に高さ方向だけを 2 倍にして出力します。

![GOTEK Mounter](/images/smcgotek01.jpg)

最終的にはこんな感じで内蔵できます。

![SMC-777 w/GOTEK](/images/smcgotek02.jpg)

# 設定

FlashFloppy の説明に従って、GOTEK に FlashFloppy のファームウェアを書き込みます。


先ほどの記事では、FF.CFG に、`pin34` の設定がされていますが、単純に次の設定で大丈夫そうです。

```FF.CFG
interface=jppc
```

SMC-777 では一般的に 1DD という形式(D88 の亜種)が使われるのですが、
このまま専用のツールで FlashFloppy で一般的な HFE に変換できません。

とりあえず、べたイメージ(RAW)で使用します。
1DD 形式のファイルのデータ部分だけをそのままくっつけた形のファイルになります。

IMAGE.CFG は先ほどの記事のものをそのまま使用します。

```IMAGE.CFG
[::286720]
cyls=70
heads=1
step=1
secs=16
bps=256
rpm=600
```

この設定で System などは起動するので、とりあえずこのまま使用します。
一部のイメージで E31 エラーになるので、できれば HFE 形式で使用したいのですが…
