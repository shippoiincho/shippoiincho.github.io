+++
title = 'Super AKI-80 を使ってみる(4)'
date = 2025-07-14T14:40:08+09:00
tags =  [ 'z80' ]
draft = true
+++
Raspberry Pi Pico2 を使って拡張する

# 概要

いままで CH32V203 を使って、Super AKI-80 を制御してきましたが、
レトロPC拡張の練習を兼ねて、Raspberry Pi Pico2 というか RP2350B を使って制御してみたいとおもいます。

実際に使用するのは WeAct Studio の RP2350B ボードで一枚 600 円程度で入手できます。
このボードは RP2350B の 48本の GPIO がすべて引き出されています。

# 方針

今回は ROM も RAM も I/O も全部 RP2350B でやらせることにします。
作例として、MSX1 もどきを目指すことにしました。

必要なコンポーネントは以下の通りです

- システムROM (Slot0: 32KB)
- RAM (Slot3: 64KB)
- カートリッジROM (Slot2)
- PPI (スロット制御・キー入力)
- PSG (音声・ジョイスティック)
- VDP (映像)

なので、大きく分けて 4 つの機能が必要です

- メモリ読み込み
- メモリ書き込み
- IO 読み込み
- IO 書き込み

# 実装

前に作ったパソピアの拡張パックのコードを改良します。

MSX ではクロックが 3.58MHz とさらに低いので、結構な余裕があります。
一番タイミング的に厳しいのは M1 サイクルのメモリアクセスで、1.5 クロック= 420nsec で対応する必要があります。

なお、実機では M1 サイクルの時に自動的にウェイトが入るのでもっと楽になります。

# おわりに

うごくんだけどなんか不安定なんだよな…