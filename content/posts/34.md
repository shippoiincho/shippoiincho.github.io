+++
title = 'HomeAssistant 環境を構築する 3'
date = 2024-05-24T09:59:25+09:00
tags = ['homeassistant' , 'esp32' ]
draft = true
+++
ESP32-C3 でセンサーデバイスを作る

# センサーデバイスを作る

HomeAssistant にはたくさんのセンサーなどが登録されていますが、日本国内で販売されている製品はあまりありません。
とりあえず、温湿度センサーと赤外線リモコンができることを目的に、センサーデバイスを作っていきます。

# センサーデバイスの構成

一番安価な ESP32-C3 でESPHome で制御させます。
温湿度センサーは以前 seeed のセールで購入した
[Grove AM2302 モジュール](https://jp.seeedstudio.com/Grove-Temperature-Humidity-Sensor-Pro-AM2302-DHT22.html)
を使います。
赤外線については、よくある赤外線 LED と、赤外線リモコン受信モジュールを用意しました。

LED はどのくらいつければいいのかわからないので、とりあえず 1個。
受信モジュールは信号学習用に 1 台のみつける予定です。

- IO04   → AM2302
- IO05   → LED 出力
- IO06   → 受信モジュール入力

# ESP32-C3 の登録

ESPHome に ESP32-C3 を登録します。
やり方は、前回と同じです。
内蔵 USB-CDC 経由でも同じやり方で初期化できます。
特に何もしていませんが、ESP32-C3 として認識されています。

# AM2302 の登録

まずは AM2302 センサーを登録します。
[ESPHome の DHT センサー](https://esphome.io/components/sensor/dht.html)を使います。
設定に以下を追記します。

```
sensor:
  - platform: dht
    pin: GPIO4
    temperature:
      name: "Temperature"
    humidity:
      name: "Humidity"
    update_interval: 60s
```

インストールすると、HomeAssistant から見えるようになります。

![AM2302 on HomeAssistant](/images/haos16.png)

# 赤外線 LED の登録

