+++
title = 'Super AKI-80 を使ってみる(1)'
date = 2025-04-21T18:00:00+09:00
tags =  [ 'z80' ]
+++
秋月電子で Super AKI-80 の保守基板とやらが 280 円で売ってたので、いろいろやってみる。

# はじめに

Super AKI-80 は東芝の TMPZ84C015 を中心としたマイコンボードです。
これは Z80 を中心として、Z80PIO、Z80SIO、Z80CTC を内蔵した今風の言い方をすれば SoC になります。
また、裏面に 8255 を２個内蔵した TMP82C265 が載っています。

![Super AKI-80](/images/aki80-00.jpg)

マニュアルによると 1992 年の製品のようですので、およそ 30年ほど前の物になります。

# 足りない部品を付け加える

これは「保守基板」とのことですので、主要部品しか載っていません

- TMP84C015 (CPU)
- TMP82C265 (PPI)
- 256Kbit SRAM
- ロジックIC (アドレスデコーダなど)

そのため以下の部品をなんとかする必要があります

- ROM
- 水晶発振器
- リセット IC
- RS232C 用レベルコンバーター
- 5V 電源レギュレータ

水晶発振器は、オリジナル通り 19.66MHz を使い、9.83MHz 動作させます。
これはシリアルの bps を 9600 の倍数にするためです。
また RS232C もないだろうということで、ここは Z80SIO の 5V 出力をそのままつかいレベルコンバーターを省略します。
電源も USB から直結することレギュレータも省略します。

# ROM をどうする?

本来は EPROM を搭載するようになっていますが、21世紀に EPROM もないだろうということで、工夫をします。
外部にマイコン(CH32V203)を用意し、Z80 バスを制御します。

- SRAM を 64KB 実装してオール RAM とする
- 起動時に DMA でブートローダを SRAM に書き込む
- 書き込んだら Z80 をリセットする

用が済んだマイコンは、IO としてなんかやらせる予定とします。

大まかなダイアグラムはこんな感じになります。

![System Diagram](/images/aki80-01.jpg)

電源オン時の動作はこんな感じを想定します。

- CH32V203 電源オン
- CH32V203 が初期化されるまで Z80 に ~RESET を投入
- RESET 解除後に、BUSREQ/BUSACK で Z80 バスを解放
- DMA で SRAM に書き込む
- もう一度 ~RESET を投入

次回実際に回路を組んでみます。